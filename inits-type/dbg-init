#!/bin/sh


function do_mount_proc {
	[ -d /proc ] || mkdir /proc
	mount -t proc     -o nodev,noexec,nosuid proc  /proc
}
function do_mount_sys {
	[ -d /sys ]  || mkdir /sys
	mount -t sysfs    -o nodev,noexec,nosuid sysfs /sys
}
function do_mount_dev {
	[ -d /dev ]  || mkdir -m 0755 /dev
	mount -t devtmpfs -o nosuid,mode=0755    udev  /dev
}
function do_mount_auto_dev {
	[ -d /dev ]  || mkdir -m 0755 /dev
	mount -o nosuid,mode=0755    udev  /dev
}
function do_mount_devpts {
	[ -d /dev/pts ] || mkdir /dev/pts
	mount -t devpts   -o noexec,nosuid,gid=5,mode=0620 devpts /dev/pts || true
}

function do_run_shell {
	exec setsid cttyhack /bin/sh
}



echo
echo "RAADBG=$RAADBG"
for ACT in $RAADBG; do
	echo "-->$ACT"
	case $ACT in
		'PROC')
			do_mount_proc
			;;
		'SYS')
			do_mount_sys
			;;
		'DEV')
			do_mount_dev
			;;
		'AUTODEV')
			do_mount_auto_dev
			;;
		'DEVPTS')
			do_mount_devpts
			;;
		*)
			echo "unsupported.. IGNORED"
			;;
	esac
done
